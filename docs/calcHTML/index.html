<!DOCTYPE html>
<html lang="en">
<head>
    <title>Meu Site</title>
</head>
<body>
    <!-- Titulo -->
    <div id="title">
        <h1>Meu Site</h1>
        <p id="my-paragraph">Hello, World!</p>
        <p id="grau-preview"></p>
    </div>

    <!-- Botao grau -->
    <div id="botao-grau">
        <input type="text" id="grau-input">
        <button type="button" onclick="defGrau()">Grau</button>
    </div>

    <!-- Espacin daora -->
    <div>
        <h1></h1>
    </div>

    <!-- Botao Funcao -->
    <div id="botao-funcao">
        <input type="text" id="my-input">
        <button type="button" onclick="inputFunc()">Funcao</button>
    </div>

    <!-- Preview Funcao -->
    <div id="preview-funcao-div">
        <p>Funcao:</p>
        <ul id="preview-funcao"></ul>
    </div>

    <!-- Espacin daora -->
    <div>
        <h1></h1>
    </div>

    <!-- Preview Raizes -->
    <div id="preview-raizes-div">
        <p>Raizes:</p>
        <ul id="preview-raizes"></ul>
    </div>

    <script>
        /* array do polinomio */
        let inputArray = [];
        
        /* grau do polinomio */
        let grau = 0;

        /* esconde o botao de funcao, o preview da funcao e o preview das raizes por default */
        divVisible("botao-funcao", false);
        divVisible("preview-funcao-div", false);
        divVisible("preview-raizes-div", false);

        /* controla a visibilidade do div chamado */
        function divVisible(div, value) {
            var x = document.getElementById(div); // pega o elemento pelo id
            if (value === true) { // se o valor for true
                x.style.display = "block"; // mostra o elemento
            } else { // se o valor for false
                x.style.display = "none"; // esconde o elemento
            }
        }
        
        /* Funcao chamada qdo aperta no botao super fofo de grau */
        function defGrau() {
            /* pega o elemento de preview do grau */
            var grauPreview = document.getElementById("grau-preview");

            /* pega o valor do input de grau */
            grau = document.getElementById("grau-input").value;
            
            /* exibe o grau no console */
            console.log("Grau:" + grau);

            /* esconde o botao de grau e mostra o de funcao */
            divVisible("botao-funcao", true);
            divVisible("botao-grau", false);

            /* preview do grau na tela */
            grauPreview.innerText = "Grau: " + grau;
        }

        /* Funcao chamada qdo aperta no botao super fofo de funcao */
        function inputFunc() {
            var inputText = document.getElementById("my-input").value; // pega o valor do input

            inputArray.push(Number(inputText)); // adiciona o valor do input no array

            document.getElementById("my-input").value = ""; // limpa o input

            console.log("Input aceito: " + inputText); // mostra o input atual no console

            if (inputArray.length === Number(grau)+1) {
                calcular(inputArray)
            }
        }

        function calcular(inputArray) {
            /* controla a visibildade do preview de funcao */
            if (document.getElementById("preview-funcao-div").style.display === "none") { // se o preview estiver escondido
                divVisible("preview-funcao-div", true); // mostra o preview
            }   
            /* controla a visibildade do preview de raizes */
            if (document.getElementById("preview-raizes-div").style.display === "none") { // se o preview estiver escondido
                divVisible("preview-raizes-div", true); // mostra o preview
            }

            let raizPreview = document.getElementById("preview-raizes"); // pega o elemento de preview das raizes
            let myParagraph = document.getElementById("preview-funcao"); // pega o elemento de preview da funcao
            myParagraph.innerHTML = inputArray.join(", "); // mostra o array na tela
            console.log(findRoots(inputArray)) // mostra as raizes no console
            raizPreview.innerHTML = findRoots(inputArray).join(", "); // mostra as raizes na tela
        }

        // funcao que acha divisores de x
        function divisors(x) {
            var divisors = []; // array vazio de divisores (aqui vai encher rlx)
            var abs_x = Math.abs(Number(x)); // pega o modulo de x
            for (var i = 1; i <= abs_x; i++) { // isso daq eh tipo "for i in range(0, len(coefficients))" no python
                if (abs_x % i === 0) { // checa se o modulo de x dividido por i = 0, se sim, eh um divisor
                    divisors.push(i); // bota i como divisor
                    divisors.push(-i) // se i eh divisor, i negativo tambem ent joga isso no array
                }
            }
        return divisors; // retorna os divisores eba
        }

        // funcao q acha f(x)
        function evaluatePolynomials(coefficients, x) {
            var degree = coefficients.length - 1; // pega o grau do polinomio
            var result = 0; // define o resultado como 0

            for (var i = 0; i < degree+1; i++) { // isso daq eh tipo "for i in range(0, len(coefficients))" no python
                result += coefficients[degree-i] * Math.pow(x, i) // adiciona o valor de f(x) a cada iteracao
            }
        return result // retorna o resultado eba2
        }

        // funcao que acha as raizes (finalmente)
        function findRoots(coefficients) {
            var degree = coefficients.length - 1; // pega o grau do polinomio DNV
            var roots = []; // array vazio de raizes (aqui vai encher tmb rlx)

            var p = divisors(Number(coefficients[degree])); // pega os divisores do ultimo termo
            var q = divisors(Number(coefficients[0])); // pega os divisores do primeiro termo

            var pq = []; // array vazio pq (aqui vai encher tmb2 rlx)

            // aqui eh tipo "for i in p" no python, soq mais bonitinho
            p.forEach((i) => {
                q.forEach((j) => { // aqui eh tipo "for j in q" no python, soq ainda mais bonitinho
                    if (!pq.includes(i/parseFloat(j))) { // checa se o valor de i/j ja ta no array pq, se nao tiver...
                        pq.push(i/parseFloat(j)) // adiciona o valor de i/j no array pq
                    }
                });
            });
            
            // aqui eh tipo "for i in pq" no python, soq mais bonitinho ainda ebaaa
            pq.forEach((i) => {
                if (evaluatePolynomials(coefficients, i) === 0) // checa se f(i) = 0, se sim...
                    roots.push(i) // adiciona i no array de raizes
            })

        return roots} // retorna as raizes eba master
    
    </script>
</body>
</html>
